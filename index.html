import React, { useState, useEffect } from 'react';
import { Mail, FileText, ExternalLink, ChevronRight, Award, Zap, BarChart3, Quote, Grape } from 'lucide-react';

const PaperWebpage = () => {
  const [scrolled, setScrolled] = useState(false);

  useEffect(() => {
    const handleScroll = () => {
      setScrolled(window.scrollY > 50);
    };
    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  const authors = [
    { name: "Dylan Zhang", email: "shizhuo2@illinois.edu", affil: "University of Illinois Urbana-Champaign", primary: true },
    { name: "Qirun Dai", email: "qirundai@uchicago.edu", affil: "University of Chicago" },
    { name: "Hao Peng", email: "haopeng@illinois.edu", affil: "University of Illinois Urbana-Champaign" }
  ];

  return (
    <div className="min-h-screen bg-slate-50 font-sans text-slate-900 selection:bg-purple-200 selection:text-purple-900">
      
      {/* Abstract Background Shapes */}
      <div className="fixed inset-0 overflow-hidden pointer-events-none z-0">
        <div className="absolute -top-20 -left-20 w-96 h-96 bg-purple-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob"></div>
        <div className="absolute top-0 -right-20 w-96 h-96 bg-indigo-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-2000"></div>
        <div className="absolute -bottom-32 left-20 w-96 h-96 bg-fuchsia-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-4000"></div>
      </div>

      {/* Navigation */}
      <nav className={`fixed top-0 w-full z-50 transition-all duration-300 ${scrolled ? 'bg-white/80 backdrop-blur-md shadow-sm py-3' : 'bg-transparent py-6'}`}>
        <div className="max-w-5xl mx-auto px-6 flex justify-between items-center">
          <div className="flex items-center gap-2 font-bold text-xl tracking-tight text-slate-800">
            <div className="p-1.5 bg-purple-600 rounded-lg text-white">
              <Grape size={20} />
            </div>
            <span>GRAPE</span>
          </div>
          <div className="hidden md:flex gap-6 text-sm font-medium text-slate-600">
            <a href="#abstract" className="hover:text-purple-600 transition-colors">Abstract</a>
            <a href="#method" className="hover:text-purple-600 transition-colors">Method</a>
            <a href="#results" className="hover:text-purple-600 transition-colors">Results</a>
          </div>
          <a 
            href="https://neurips.cc/virtual/2025/loc/san-diego/poster/119926" 
            target="_blank"
            rel="noopener noreferrer"
            className="flex items-center gap-2 bg-slate-900 text-white px-4 py-2 rounded-full text-sm font-semibold hover:bg-slate-800 transition-all shadow-lg hover:shadow-purple-500/20"
          >
            NeurIPS 2025 <ExternalLink size={14} />
          </a>
        </div>
      </nav>

      {/* Hero Section */}
      <header className="relative pt-32 pb-20 z-10">
        <div className="max-w-4xl mx-auto px-6 text-center">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-purple-100 text-purple-700 text-xs font-bold uppercase tracking-wider mb-6 border border-purple-200">
            <Award size={14} /> NeurIPS 2025 Camera Ready
          </div>
          
          <h1 className="text-4xl md:text-6xl font-extrabold tracking-tight mb-8 leading-tight text-transparent bg-clip-text bg-gradient-to-r from-slate-900 via-purple-900 to-slate-900 pb-2">
            The Best Instruction-Tuning Data <br className="hidden md:block" /> are Those That Fit
          </h1>
          
          <div className="flex flex-wrap justify-center gap-y-4 gap-x-8 mb-10 text-lg">
            {authors.map((author, index) => (
              <div key={index} className="group relative">
                <div className="font-semibold text-slate-800 flex items-center gap-2">
                  {author.name}
                  {author.primary && (
                    <a href={`mailto:${author.email}`} className="text-slate-400 hover:text-purple-600 transition-colors" title={author.email}>
                      <Mail size={16} />
                    </a>
                  )}
                </div>
                <div className="text-sm text-slate-500">{author.affil}</div>
              </div>
            ))}
          </div>

          <div className="flex flex-col sm:flex-row justify-center gap-4">
            <a 
              href="https://neurips.cc/virtual/2025/loc/san-diego/poster/119926" 
              target="_blank"
              rel="noopener noreferrer"
              className="flex items-center justify-center gap-2 px-8 py-3.5 bg-purple-600 text-white rounded-xl font-bold text-lg hover:bg-purple-700 transition-all shadow-xl shadow-purple-200 hover:shadow-purple-300 transform hover:-translate-y-1"
            >
              <FileText size={20} />
              Read Paper
            </a>
            <button 
              onClick={() => {
                 navigator.clipboard.writeText("Dylan Zhang: shizhuo2@illinois.edu");
                 alert("Email copied to clipboard!");
              }}
              className="flex items-center justify-center gap-2 px-8 py-3.5 bg-white text-slate-700 border border-slate-200 rounded-xl font-bold text-lg hover:bg-slate-50 transition-all shadow-md hover:shadow-lg transform hover:-translate-y-1"
            >
              <Mail size={20} />
              Contact Author
            </button>
          </div>
        </div>
      </header>

      <main className="max-w-5xl mx-auto px-6 pb-24 relative z-10 space-y-24">
        
        {/* Summary / Abstract Section */}
        <section id="abstract" className="relative">
          <div className="absolute -inset-4 bg-white/60 backdrop-blur-xl rounded-3xl border border-white/50 shadow-2xl shadow-purple-100/50 -z-10"></div>
          <div className="md:grid md:grid-cols-12 gap-12 p-8 md:p-12 items-start">
            <div className="md:col-span-4 mb-8 md:mb-0">
              <h2 className="text-2xl font-bold mb-4 flex items-center gap-2">
                <Quote className="text-purple-500" />
                Summary
              </h2>
              <p className="text-slate-500 leading-relaxed text-sm">
                A brief overview of how tailoring supervision to the target model creates better instruction-tuned agents.
              </p>
            </div>
            <div className="md:col-span-8">
              <p className="text-lg leading-relaxed text-slate-700 mb-6">
                High-quality supervised finetuning (SFT) data are essential for unlocking LLM capabilities. However, standard SFT data often comes from sources <span className="font-semibold text-purple-700">out of distribution</span> for the target model.
              </p>
              <p className="text-lg leading-relaxed text-slate-700 mb-6">
                We propose <span className="font-bold text-purple-900">GRAPE</span>, a novel framework that hypothesizes that SFT is most effective when data is aligned to the model's pretrained distribution.
              </p>
              <div className="bg-purple-50 p-6 rounded-2xl border border-purple-100">
                <h3 className="font-bold text-purple-900 mb-2 flex items-center gap-2">
                  <Zap size={18} /> The Core Idea
                </h3>
                <p className="text-purple-800">
                  For each instruction, GRAPE gathers responses from various sources and selects the one that aligns most closely to the target model's pretrained distribution (highest normalized probability). We then perform standard SFT on this curated subset.
                </p>
              </div>
            </div>
          </div>
        </section>

        {/* Key Methodology */}
        <section id="method">
            <div className="text-center mb-12">
                <h2 className="text-3xl font-bold text-slate-900 mb-4">How GRAPE Works</h2>
                <p className="text-slate-500 max-w-2xl mx-auto">A simple, effective pipeline to maximize data suitability.</p>
            </div>
            
            <div className="grid md:grid-cols-3 gap-6">
                {[
                    {
                        step: "01",
                        title: "Gather Responses",
                        desc: "Collect a diverse pool of responses for each instruction from various sources (humans, different LLMs).",
                        icon: <div className="grid grid-cols-2 gap-1 w-8 h-8 opacity-50"><div className="bg-current rounded-sm"></div><div className="bg-current rounded-sm"></div><div className="bg-current rounded-sm"></div><div className="bg-current rounded-sm"></div></div>
                    },
                    {
                        step: "02",
                        title: "Measure Alignment",
                        desc: "Calculate the length-normalized probability of each response using the target model itself.",
                        icon: <BarChart3 size={32} className="opacity-50" />
                    },
                    {
                        step: "03",
                        title: "Select & Finetune",
                        desc: "Keep only the highest-probability response for each instruction and perform standard SFT.",
                        icon: <Award size={32} className="opacity-50" />
                    }
                ].map((item, i) => (
                    <div key={i} className="bg-white p-8 rounded-2xl shadow-sm border border-slate-100 hover:shadow-xl hover:-translate-y-1 transition-all duration-300 group">
                        <div className="flex justify-between items-start mb-6">
                            <span className="text-5xl font-black text-slate-100 group-hover:text-purple-100 transition-colors">{item.step}</span>
                            <div className="text-slate-300 group-hover:text-purple-500 transition-colors">{item.icon}</div>
                        </div>
                        <h3 className="text-xl font-bold mb-3 text-slate-800">{item.title}</h3>
                        <p className="text-slate-500 leading-relaxed">{item.desc}</p>
                    </div>
                ))}
            </div>
        </section>

        {/* Results Highlights */}
        <section id="results" className="bg-slate-900 text-white rounded-3xl p-8 md:p-16 relative overflow-hidden">
            {/* Background pattern */}
            <div className="absolute top-0 right-0 w-64 h-64 bg-purple-500 rounded-full mix-blend-overlay filter blur-3xl opacity-20"></div>
            <div className="absolute bottom-0 left-0 w-64 h-64 bg-blue-500 rounded-full mix-blend-overlay filter blur-3xl opacity-20"></div>

            <div className="relative z-10">
                <div className="flex flex-col md:flex-row md:items-end justify-between mb-12 border-b border-slate-700 pb-8">
                    <div>
                        <h2 className="text-3xl font-bold mb-2">Impressive Gains</h2>
                        <p className="text-slate-400">Outperforming strong baselines and larger datasets.</p>
                    </div>
                    <div className="mt-4 md:mt-0">
                       <span className="inline-flex items-center gap-1 text-purple-300 font-medium">
                            See paper for full benchmarks <ChevronRight size={16} />
                       </span>
                    </div>
                </div>

                <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <div className="space-y-2">
                        <div className="text-4xl font-extrabold text-purple-400">17.3%</div>
                        <div className="text-sm font-medium text-slate-300 uppercase tracking-wide">Performance Gain</div>
                        <p className="text-sm text-slate-400">Improvement over baselines trained on 3x more data.</p>
                    </div>
                    <div className="space-y-2">
                        <div className="text-4xl font-extrabold text-blue-400">13.8%</div>
                        <div className="text-sm font-medium text-slate-300 uppercase tracking-wide">Distillation Gain</div>
                        <p className="text-sm text-slate-400">Beat distilling from the strongest teacher model (Llama 3.1 405B).</p>
                    </div>
                    <div className="space-y-2">
                        <div className="text-4xl font-extrabold text-emerald-400">1/3</div>
                        <div className="text-sm font-medium text-slate-300 uppercase tracking-wide">Data Efficiency</div>
                        <p className="text-sm text-slate-400">Surpassed Tulu3-SFT performance using only a fraction of the data.</p>
                    </div>
                    <div className="space-y-2">
                        <div className="text-4xl font-extrabold text-fuchsia-400">SOTA</div>
                        <div className="text-sm font-medium text-slate-300 uppercase tracking-wide">Generalization</div>
                        <p className="text-sm text-slate-400">Consistent improvements across coding, math, and logic benchmarks.</p>
                    </div>
                </div>
            </div>
        </section>

      </main>

      <footer className="bg-white border-t border-slate-200 py-12">
        <div className="max-w-5xl mx-auto px-6 text-center">
            <p className="text-slate-500 mb-4">
                © 2025 GRAPE Project. NeurIPS 2025 Camera Ready.
            </p>
            <div className="flex justify-center gap-6 text-sm font-medium text-slate-600">
                <a href="mailto:shizhuo2@illinois.edu" className="hover:text-purple-600 transition-colors">Contact Dylan Zhang</a>
                <span>•</span>
                <a href="https://neurips.cc/virtual/2025/loc/san-diego/poster/119926" target="_blank" rel="noreferrer" className="hover:text-purple-600 transition-colors">View Poster</a>
            </div>
        </div>
      </footer>
      
      <style>{`
        @keyframes blob {
          0% { transform: translate(0px, 0px) scale(1); }
          33% { transform: translate(30px, -50px) scale(1.1); }
          66% { transform: translate(-20px, 20px) scale(0.9); }
          100% { transform: translate(0px, 0px) scale(1); }
        }
        .animate-blob {
          animation: blob 7s infinite;
        }
        .animation-delay-2000 {
          animation-delay: 2s;
        }
        .animation-delay-4000 {
          animation-delay: 4s;
        }
      `}</style>
    </div>
  );
};

export default PaperWebpage;